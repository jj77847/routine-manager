<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Routine Manager</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    margin: 0; padding: 0; background: #f9f9f9;
    color: #333;
  }
  header {
    background: #222; color: white; padding: 1rem; text-align: center;
  }
  main {
    max-width: 720px; margin: 1rem auto; padding: 1rem; background: white; border-radius: 8px;
    box-shadow: 0 0 12px rgba(0,0,0,0.1);
  }
  label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
  }
  select {
    width: 100%;
    padding: 0.5rem;
    font-size: 1rem;
    margin-bottom: 1rem;
  }
  .routine-title {
    font-size: 1.8rem;
    margin-bottom: 0.3rem;
  }
  .routine-info {
    font-style: italic;
    margin-bottom: 1rem;
    color: #555;
  }
  ul.exercise-list {
    list-style: none;
    padding: 0;
    margin: 0 0 1rem 0;
  }
  ul.exercise-list li {
    background: #eee;
    margin-bottom: 0.5rem;
    padding: 0.6rem 0.8rem;
    border-radius: 4px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  ul.exercise-list li input {
    font-size: 1rem;
    margin-right: 0.4rem;
    width: 100%;
  }
  ul.exercise-list li span {
    flex-grow: 1;
  }
  ul.exercise-list li button {
    margin-left: 0.5rem;
    background: #c33;
    color: white;
    border: none;
    border-radius: 3px;
    cursor: pointer;
    padding: 0.3rem 0.6rem;
    font-weight: 600;
  }
  ul.exercise-list li button:hover {
    background: #a00;
  }
  .add-exercise {
    display: flex;
    margin-bottom: 1rem;
  }
  .add-exercise input {
    flex-grow: 1;
    padding: 0.5rem;
    font-size: 1rem;
  }
  .add-exercise button {
    padding: 0.5rem 1rem;
    font-weight: 600;
    margin-left: 0.5rem;
    background: #28a745;
    border: none;
    border-radius: 4px;
    color: white;
    cursor: pointer;
  }
  .add-exercise button:hover {
    background: #218838;
  }
  .save-btn {
    background: #007bff;
    border: none;
    color: white;
    padding: 0.6rem 1.2rem;
    font-size: 1rem;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 0.5rem;
  }
  .save-btn:hover {
    background: #0056b3;
  }
  .reset-btn {
    background: #dc3545;
    border: none;
    color: white;
    padding: 0.6rem 1.2rem;
    font-size: 1rem;
    border-radius: 5px;
    cursor: pointer;
    margin-left: 1rem;
  }
  .reset-btn:hover {
    background: #a71d2a;
  }
  /* Routine color coding */
  .routine-container {
    padding: 1rem;
    border-radius: 8px;
  }
  .routine-rings {
    background-color: #cce5ff;
    border: 2px solid #339af0;
    color: #0b61a4;
  }
  .routine-park {
    background-color: #d4edda;
    border: 2px solid #28a745;
    color: #19692c;
  }
  .routine-home {
    background-color: #fff3cd;
    border: 2px solid #ffc107;
    color: #856404;
  }
  .routine-mobility {
    background-color: #e3d7f3;
    border: 2px solid #6f42c1;
    color: #4e2a8e;
  }
  .routine-stretch {
    background-color: #f8d7da;
    border: 2px solid #dc3545;
    color: #721c24;
  }
  .routine-balance {
    background-color: #d1ecf1;
    border: 2px solid #17a2b8;
    color: #0c5460;
  }
  .routine-yoga {
    background-color: #c3e6cb;
    border: 2px solid #28a745;
    color: #155724;
  }
  .routine-taichi {
    background-color: #f5e6cc;
    border: 2px solid #b07d2a;
    color: #6e5219;
  }
  .routine-busy-dad {
    background-color: #f8d7da;
    border: 2px solid #dc3545;
    color: #721c24;
  }
  .routine-minimalist {
    background-color: #e2e3e5;
    border: 2px solid #6c757d;
    color: #383d41;
  }
  /* Responsive */
  @media (max-width: 480px) {
    .add-exercise {
      flex-direction: column;
    }
    .add-exercise button {
      margin-left: 0;
      margin-top: 0.5rem;
    }
  }
</style>
</head>
<body>
<header>
  <h1>Routine Manager</h1>
</header>
<main>
  <label for="routine-select">Select Routine:</label>
  <select id="routine-select" aria-label="Select routine"></select>

  <div id="routine-container" class="routine-container">
    <!-- Routine details will render here -->
  </div>

  <button id="reset-btn" class="reset-btn" title="Reset routines to defaults">Reset to Default Routines</button>
</main>

<script>
(() => {
  // Default routines data
  const defaultRoutines = [
    {
      id: "rings",
      name: "Rings Workout",
      colorClass: "routine-rings",
      info: "3×30s Ring Supports, 5×1 Skin the Cat, 3×5 Ring Dips, 3×5 Ring Rows, 3×10 Ring Press-ups, 3×10 Ring Squats.",
      exercises: [
        { name: "Ring Supports", sets: 3, reps: "30s" },
        { name: "Skin the Cat", sets: 5, reps: 1 },
        { name: "Ring Dips", sets: 3, reps: 5 },
        { name: "Ring Rows", sets: 3, reps: 5 },
        { name: "Ring Press-ups", sets: 3, reps: 10 },
        { name: "Ring Squats", sets: 3, reps: 10 }
      ]
    },
    {
      id: "park",
      name: "Park Workout",
      colorClass: "routine-park",
      info: "Circuit includes squats, pull-ups, push-ups, dips, knee raises, and jogging.",
      exercises: [
        { name: "Squats", sets: 1, reps: 10 },
        { name: "Pull-Ups", sets: 4, reps: [3,3,3,1] },
        { name: "Push-Ups", sets: 1, reps: 10 },
        { name: "Dips", sets: 2, reps: 5 },
        { name: "Knee Raises", sets: 1, reps: 10 },
        { name: "Jog", sets: 1, reps: "10 min" }
      ]
    },
    {
      id: "home",
      name: "Home Workout",
      colorClass: "routine-home",
      info: "Home workout with press-ups, assisted squats, burpees and planks.",
      exercises: [
        { name: "Press-Ups", sets: 5, reps: 10 },
        { name: "Assisted Squats", sets: 5, reps: 10 },
        { name: "Burpees", sets: 5, reps: 10 },
        { name: "Plank", sets: 5, reps: "1 min" }
      ]
    }
  ];

  const routineSelect = document.getElementById("routine-select");
  const routineContainer = document.getElementById("routine-container");
  const resetBtn = document.getElementById("reset-btn");

  // Load routines from localStorage or default
  function loadRoutines() {
    const saved = localStorage.getItem("routinesData");
    if (saved) {
      try {
        return JSON.parse(saved);
      } catch {
        return [...defaultRoutines];
      }
    }
    return [...defaultRoutines];
  }

  // Save routines to localStorage
  function saveRoutines(data) {
    localStorage.setItem("routinesData", JSON.stringify(data));
  }

  let routines = loadRoutines();

  // Populate dropdown
  function populateDropdown() {
    routineSelect.innerHTML = "";
    routines.forEach(r => {
      const option = document.createElement("option");
      option.value = r.id;
      option.textContent = r.name;
      routineSelect.appendChild(option);
    });
  }

  // Render routine details
  function renderRoutine(routine) {
    routineContainer.className = "routine-container " + routine.colorClass;
    routineContainer.innerHTML = "";

    const title = document.createElement("h2");
    title.className = "routine-title";
    title.textContent = routine.name;
    routineContainer.appendChild(title);

    if (routine.info) {
      const info = document.createElement("p");
      info.className = "routine-info";
      info.textContent = routine.info;
      routineContainer.appendChild(info);
    }

    // Exercises list
    const ul = document.createElement("ul");
    ul.className = "exercise-list";

    routine.exercises.forEach((ex, i) => {
      const li = document.createElement("li");

      const span = document.createElement("span");
      span.textContent = ex.name + " — Sets: ";
      li.appendChild(span);

      // Sets input
      const setsInput = document.createElement("input");
      setsInput.type = "number";
      setsInput.min = 0;
      setsInput.value = ex.sets;
      setsInput.title = "Sets";
      setsInput.style.width = "50px";
      setsInput.addEventListener("change", e => {
        const val = parseInt(e.target.value, 10);
        if (!isNaN(val) && val >= 0) {
          routines.find(r => r.id === routine.id).exercises[i].sets = val;
          saveRoutines(routines);
        } else {
          e.target.value = routines.find(r => r.id === routine.id).exercises[i].sets;
        }
      });
      li.appendChild(setsInput);

      const repsSpan = document.createElement("span");
      repsSpan.textContent = " Reps: ";
      li.appendChild(repsSpan);

      // Reps input
      const repsInput = document.createElement("input");
      repsInput.type = "text";
      repsInput.value = Array.isArray(ex.reps) ? ex.reps.join(", ") : ex.reps;
      repsInput.title = "Reps (number, time, or list)";
      repsInput.style.width = "100px";
      repsInput.addEventListener("change", e => {
        let val = e.target.value.trim();
        // If comma separated numbers, convert to array of numbers
        if (val.includes(",")) {
          const arr = val.split(",").map(x => x.trim());
          // Try convert numeric strings to numbers
          const converted = arr.map(x => isNaN(x) ? x : Number(x));
          routines.find(r => r.id === routine.id).exercises[i].reps = converted;
        } else if (!isNaN(val)) {
          routines.find(r => r.id === routine.id).exercises[i].reps = Number(val);
        } else {
          routines.find(r => r.id === routine.id).exercises[i].reps = val;
        }
        saveRoutines(routines);
      });
      li.appendChild(repsInput);

      // Delete button
      const delBtn = document.createElement("button");
      delBtn.textContent = "Delete";
      delBtn.title = "Delete exercise";
      delBtn.addEventListener("click", () => {
        if (confirm(`Delete exercise "${ex.name}"?`)) {
          const routineIndex = routines.findIndex(r => r.id === routine.id);
          if (routineIndex > -1) {
            routines[routineIndex].exercises.splice(i, 1);
            saveRoutines(routines);
            renderRoutine(routines[routineIndex]);
          }
        }
      });
      li.appendChild(delBtn);

      ul.appendChild(li);
    });

    routineContainer.appendChild(ul);

    // Add new exercise form
    const addDiv = document.createElement("div");
    addDiv.className = "add-exercise";

    const addInput = document.createElement("input");
    addInput.type = "text";
    addInput.placeholder = "New exercise name";
    addInput.title = "Enter new exercise name";
    addDiv.appendChild(addInput);

    const addSets = document.createElement("input");
    addSets.type = "number";
    addSets.min = 0;
    addSets.placeholder = "Sets";
    addSets.title = "Sets";
    addSets.style.width = "60px";
    addDiv.appendChild(addSets);

    const addReps = document.createElement("input");
    addReps.type = "text";
    addReps.placeholder = "Reps (e.g. 10 or 10,5,5 or 30s)";
    addReps.title = "Reps";
    addReps.style.width = "100px";
    addDiv.appendChild(addReps);

    const addBtn = document.createElement("button");
    addBtn.textContent = "Add Exercise";
    addBtn.title = "Add exercise to routine";
    addBtn.addEventListener("click", () => {
      const name = addInput.value.trim();
      const sets = parseInt(addSets.value, 10);
      const repsRaw = addReps.value.trim();

      if (!name) {
        alert("Please enter exercise name.");
        return;
      }
      if (isNaN(sets) || sets < 0) {
        alert("Please enter valid number of sets.");
        return;
      }
      if (!repsRaw) {
        alert("Please enter reps.");
        return;
      }

      let reps;
      if (repsRaw.includes(",")) {
        reps = repsRaw.split(",").map(x => {
          const n = x.trim();
          return isNaN(n) ? n : Number(n);
        });
      } else if (!isNaN(repsRaw)) {
        reps = Number(repsRaw);
      } else {
        reps = repsRaw;
      }

      const routineIndex = routines.findIndex(r => r.id === routine.id);
      if (routineIndex > -1) {
        routines[routineIndex].exercises.push({ name, sets, reps });
        saveRoutines(routines);
        renderRoutine(routines[routineIndex]);
        addInput.value = "";
        addSets.value = "";
        addReps.value = "";
      }
    });
    addDiv.appendChild(addBtn);

    routineContainer.appendChild(addDiv);
  }

  // Event: on routine select change
  routineSelect.addEventListener("change", e => {
    const selectedId = e.target.value;
    const routine = routines.find(r => r.id === selectedId);
    if (routine) {
      renderRoutine(routine);
    }
  });

  // Reset to defaults
  resetBtn.addEventListener("click", () => {
    if (confirm("Are you sure you want to reset all routines to defaults? This will erase all your edits.")) {
      routines = [...defaultRoutines];
      saveRoutines(routines);
      populateDropdown();
      routineSelect.selectedIndex = 0;
      renderRoutine(routines[0]);
    }
  });

  // Init app
  function init() {
    populateDropdown();
    // Show first routine by default
    if (routines.length > 0) {
      routineSelect.value = routines[0].id;
      renderRoutine(routines[0]);
    }
  }

  init();
})();
</script>
</body>
</html>
